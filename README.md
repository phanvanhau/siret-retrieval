This is home assignment for enterprise SIRET retrieval
# Build instructions
## Buid and run with Docker (easiest way)
At the root of the project
```
chmod +x ./docker/build.sh
./docker/build.sh
docker run -it --rm --name siret-retrieval -p 9000:9000 siret-retrievel:0.0.1
```
## Local development
```
# Build
./mvnw clean package

#Run
DB_FILE_LOCATION={path_to_your_db_folder} #change value here
cp ./src/main/resources/siret_table.csv ${DB_FILE_LOCATION}/siret_table.csv
cp ./src/main/resources/enterprise_table.csv ${DB_FILE_LOCATION}/enterprise_table.csv

DB_FILE_LOCATION={path_to_your_db_folder} ./mvnw spring-boot:run
OR
DB_FILE_LOCATION={path_to_your_db_folder} java -jar target/siret-retrieval-0.0.1-SNAPSHOT.jar
```
## Test the endpoint
```
curl -k -X POST 'http://localhost:9000/enterprise/batchUpdate'

docker ps
# Note "CONTAINER ID" corresponding to "IMAGE" siret-retrievel:0.0.1

# Connect to docker container and open sh terminal in interactive mode
docker exec -it {CONTAINER_ID} /bin/sh

# Verify the data is persisted in the file
cat /usr/db/siret-retrieval/enterprise_table.csv
```

# How to improve the project
- Secure the microservice using Spring Security, by authorizing only the caller having the valid jwt token (generated by public key pair of the private key known by the microservice target) 
- Generate the microservice client API and server API with swagger
    - The client API could be imported by other microservices without the need for the caller to add more code to build the HTTP request
    - The server API would be deployed independently
- The process updating enterprise data would be heavy if the number of registered enterprise is important.
The current implementation has been done with non-blocking mechanism but without the need for the caller to know the process status, also detailed failure if any.
    - Use Spring Batch could be more relevant for this kind of job
    - Return the process id and provide another endpoint for the caller to check the job status. 
- Nevertheless, the end to end testing could be added to the project also (Example: using https://rest-assured.io/)
